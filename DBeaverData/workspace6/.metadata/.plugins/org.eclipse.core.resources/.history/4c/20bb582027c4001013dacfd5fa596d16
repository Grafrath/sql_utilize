use academy_db;

-- 학생 테이블
CREATE TABLE student (
  id INT PRIMARY KEY,
  name VARCHAR(50)
);

INSERT INTO student (id, name) VALUES
(1, '철수'),
(2, '영희'),
(3, '민수');

-- 수강 테이블
CREATE TABLE enroll (
  id INT PRIMARY KEY,
  student_id INT,
  class_name VARCHAR(50),
  constraint STD_FK foreign key  (student_id) REFERENCES student(id)
);

INSERT INTO enroll (id, student_id, class_name) VALUES
(1, 1, '데이터베이스'),
(2, 1, '자바'),
(3, 2, '데이터베이스');

select * from student;

select * from enroll;

select s.name, e.class_name from student s
inner join enroll e on e.student_id = s.id;

alter table product RENAME product_old;

-- 상품 테이블
CREATE TABLE product (
  id INT PRIMARY KEY,
  name VARCHAR(50),
  price INT
);

INSERT INTO product VALUES
(1, '노트북', 1200000),
(2, '스마트폰', 800000),
(3, '키보드', 50000),
(4, '마우스', 30000),
(5, '모니터', 200000);

-- 주문 테이블
CREATE TABLE order_list (
  order_id INT PRIMARY KEY,
  product_id INT,
  quantity INT,
  order_date DATE,
  FOREIGN KEY (product_id) REFERENCES product(id)
);

INSERT INTO order_list VALUES
(101, 1, 1, '2025-01-01'),
(102, 3, 2, '2025-01-02'),
(103, 2, 1, '2025-01-02'),
(104, 5, 3, '2025-01-03'),
(105, 1, 1, '2025-01-04');

-- 상품이름과 주문수량 조회
select p.name, l.quantity from product p
INNER JOIN order_list l ON p.id = l.product_id;

-- 주문된 모든 상품의 상품명, 가격, 주문날짜 조회
select l.order_id, p.name, p.price, l.order_date from product p
INNER JOIN order_list l ON p.id = l.product_id ORDER BY l.order_id;

-- 상품이름이 노트북인 주문의 주문id, 수량, 날짜 조회
select l.order_id, l.quantity, l.order_date from order_list l
INNER JOIN product p ON p.id = l.product_id WHERE p.name = '노트북';

-- 2025-1-2에 주문된 상품들의 상품 이름과 수량 조회
select p.name, l.quantity from order_list l
INNER JOIN product p ON p.id = l.product_id WHERE l.order_date = '2025-01-02';

-- 상품명, 수량, 가격, 주문금액(가격*수량)을 함께 출력
select p.name, l.quantity from order_list l
INNER JOIN product p ON p.id = l.product_id

-- 2번이상 주문된적 있는 상품의 상품명과 총 주문횟수 조회